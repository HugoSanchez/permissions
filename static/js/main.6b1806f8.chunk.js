(window.webpackJsonppermissions=window.webpackJsonppermissions||[]).push([[0],{1e3:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=1e3},1193:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(6),o=n.n(s),l=(n(448),n(4)),c=n.n(l),i=n(74),u=n(199),d=n(441),p=n(422),f=n(201),E=n(1194),m=n(1198),g=n(15),y=n(1203),b=n(1201),v=n(63),O=n(432),k=n(1202),A=n(1195),w=n(149),h=m.a.Text,D=m.a.Title,x=w.a.Option;function T(e){var t=e.tokenSelectOpts,n=e.onChange;return a.a.createElement(a.a.Fragment,null,a.a.createElement(D,{level:3},"Please Select a Token"),a.a.createElement(h,{style:{paddingTop:20,paddingBottom:20,width:"100%"}},"Once you select a token, you will be able to manage administrators and operators of various Security Token features"),a.a.createElement(w.a,{autoFocus:!0,showSearch:!0,style:{width:"100%",marginBottom:40},placeholder:"Select a token",optionFilterProp:"children",onChange:function(e){return n(e)},filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map((function(e){var t=e.label,n=e.value;return a.a.createElement(x,{key:n,value:n},t)}))))}var I=n(1196),R=n(1197),L=n(1199),S=n(1200),G=n(428),j=n(429),_=I.a.Column,C=m.a.Text,N=R.a.Item,F=w.a.Option,M={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},P={PermissionsAdministrator:"Permissions Administrator",ShareholdersAdministrator:"Shareholders Administrator"};function U(e){var t=e.records,n=e.revokeRole,s=e.assignRole,o=e.roles;t=t.map((function(e){var t=e.address;return{key:t,address:t,role:e.role}}));var l=Object(G.a)(),d=l.getFieldDecorator,p=l.validateFields,f=(l.errors,l.values,l.resetFields),E=Object(r.useState)(!1),m=Object(u.a)(E,2),y=m[0],b=m[1],O=o.map((function(e){return{value:e,label:P[e]}})),k=function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(["address","role"],{force:!0}).then(function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.prev=1,e.next=4,s(t.address,t.role);case 4:f(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(v.a,{type:"primary",onClick:function(){return b(!0)},style:{alignSelf:"flex-end",marginBottom:20}},"Assign a role"),a.a.createElement(L.a,{title:"Assign a role",okText:"Save",closable:!1,visible:y,footer:null},a.a.createElement(R.a,M,a.a.createElement(N,{name:"address",label:"Address"},d("address",{rules:[{required:!0},{validator:function(e,t,n){j.utils.isAddress(t)?n():n("Address is invalid")}}]})(a.a.createElement(S.a,null))),a.a.createElement(N,{name:"role",label:"Role"},d("role",{rules:[{required:!0}]})(a.a.createElement(w.a,null,O.map((function(e){var t=e.value,n=e.label;return a.a.createElement(F,{value:t},n)}))))),a.a.createElement(N,{name:"details",label:"Details"},d("details")(a.a.createElement(S.a,null))),a.a.createElement(N,null,a.a.createElement(v.a,{onClick:function(){return b(!1)}},"Cancel"),a.a.createElement(v.a,{type:"primary",onClick:k},"Save")))),a.a.createElement(I.a,{size:"middle",dataSource:t,rowKey:function(e,t){return"".concat(e,"-").concat(t)}},a.a.createElement(_,{title:"Address",dataIndex:"address",key:"address",render:function(e){return a.a.createElement(C,null,e)}}),a.a.createElement(_,{title:"Role",dataIndex:"role",key:"role",render:function(e){return a.a.createElement(C,null,ne(e))}}),a.a.createElement(_,{title:"Actions",render:function(e,t){return a.a.createElement(r.Fragment,null,a.a.createElement(v.a,{onClick:function(){return n(t.address,t.role)}},a.a.createElement(g.a,{type:"delete",theme:"filled"})))}})))}function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=E.a.Content,Z=E.a.Header,z=E.a.Sider,q=m.a.Text,J="Permissions",W={1:{polymathRegistryAddress:"0xdfabf3e4793cd30affb47ab6fa4cf4eef26bbc27"},42:{polymathRegistryAddress:"0x5b215a7d39ee305ad28da29bf2f0425c6c2a00b3"},15:{polymathRegistryAddress:"0x9FBDa871d559710256a2502A2517b794B482Db40"}};function H(e){var t=e.networkId;return a.a.createElement(r.Fragment,null,a.a.createElement(g.a,{type:"global",style:{marginRight:10,marginLeft:20}}),a.a.createElement(q,null,{0:"Disconnected",1:"Mainnet",42:"Kovan"}[t]))}function $(e){var t=e.walletAddress;return t?a.a.createElement(r.Fragment,null,a.a.createElement(g.a,{type:"user",style:{marginRight:5,marginLeft:10}}),a.a.createElement(q,null,t)):null}function Q(e){var t=e.features,n=e.pmEnabled,r=e.onClick;return a.a.createElement(y.a,{column:4},a.a.createElement(y.a.Item,{key:"Permissions",label:"Permissions"},n?a.a.createElement(b.a,{status:"success",text:"enabled"}):a.a.createElement(v.a,{type:"primary",onClick:r},"Enable")),"}",Object.keys(t).map((function(e){return a.a.createElement(y.a.Item,{key:e,label:ne(e)},a.a.createElement(b.a,{status:t[e]?"success":"error",text:t[e]?"enabled":"disabled"}))})))}var X=function(){var e=Object(r.useContext)(te),t=Object(u.a)(e,2),n=t[0],s=t[1],o=n.AppReducer,l=o.sdk,d=o.loading,p=o.loadingMessage,m=o.walletAddress,g=o.error,y=o.networkId,b=o.tokens,v=o.tokenIndex,w=o.pmEnabled,h=o.delegates,D=o.features,x=o.availableRoles,I=b[v];function R(){return(R=Object(i.a)(c.a.mark((function e(t){var n,r,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s({type:"TOGGLING_PM"}),!t){e.next=12;break}return e.next=5,I.features.enable({feature:J});case 5:return n=e.sent,e.next=8,n.run();case 8:r=e.sent,console.log(r),e.next=19;break;case 12:return e.next=14,I.features.disable({feature:J});case 14:return a=e.sent,e.next=17,a.run();case 17:o=e.sent,console.log(o);case 19:s({type:"TOGGLED_PM",pmEnabled:!t}),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(0),console.error(e.t0),s({type:"ERROR",error:e.t0.message});case 26:case"end":return e.stop()}}),e,null,[[0,22]])})))).apply(this,arguments)}Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(c.a.mark((function e(){var t,n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"INITALIZING"}),e.prev=1,e.next=4,f.browserUtils.getNetworkId();case 4:return t=e.sent,e.next=7,f.browserUtils.getCurrentAddress();case 7:if(n=e.sent,[-1,1,42].includes(t)){e.next=11;break}return s({type:"ERROR",error:"Please switch to either Main or Kovan network"}),e.abrupt("return");case 11:return r=W[t],a=new f.Polymath,e.next=15,a.connect(r);case 15:s({type:"INITIALIZED",networkId:t,sdk:a,walletAddress:n}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),s({type:"ERROR",error:e.t0.message});case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}l||function(){e.apply(this,arguments)}()}),[s,l]),Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(c.a.mark((function e(t,n,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"LOADING_TOKENS"}),e.next=3,n.getSecurityTokens({walletAddress:r});case 3:a=e.sent,t({type:"LOADED_TOKENS",tokens:a});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l&&m&&0===b.length&&function(t,n,r){e.apply(this,arguments)}(s,l,m)}),[m,l,s,b]),Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"LOADING_FEATURES_STATUS"}),e.next=3,I.features.getStatus();case 3:if(t=e.sent,n=[],console.log(t),r=t[J],delete t[J],!r){e.next=12;break}return e.next=11,I.permissions.getAvailableRoles();case 11:n=e.sent;case 12:s({type:"LOADED_FEATURES_STATUS",availableRoles:n,features:t,pmEnabled:r});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}I&&function(){e.apply(this,arguments)}()}),[x,s,I]),Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"LOADING_DELEGATES"}),e.next=3,I.permissions.getAllDelegates();case 3:t=e.sent,console.log("delegates",t),s({type:"LOADED_DELEGATES",delegates:t});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}w&&function(){e.apply(this,arguments)}()}),[b,w,s,I]);var L=function(){var e=Object(i.a)(c.a.mark((function e(t,n){var r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s({type:"REMOVING_DELEGATE",address:t}),e.next=4,I.permissions.revokeRole({delegateAddress:t,role:n});case 4:return r=e.sent,console.log(r),e.next=8,r.run();case 8:a=e.sent,console.log("res",a),s({type:"REMOVED_DELEGATE"}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),s({type:"ERROR",error:e.t0.message});case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}(),S=function(){var e=Object(i.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s({type:"ADDING_DELEGATE",address:t}),e.next=4,I.permissions.assignRole({delegateAddress:t,role:n});case 4:return r=e.sent,console.log(r),e.next=8,r.run();case 8:e.sent,s({type:"ADDED_DELEGATE"}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),s({type:"ERROR",error:e.t0.message});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),G=b.map((function(e,t){return{label:e.symbol,value:t}})),j=h.reduce((function(e,t,n){return e.concat(t.roles.map((function(e){return{address:h[n].delegateAddress,role:e}})))}),[]);return a.a.createElement("div",null,a.a.createElement(O.a,{spinning:d,tip:p,size:"large"},a.a.createElement(E.a,null,a.a.createElement(Z,{style:{backgroundColor:"white",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},a.a.createElement(H,{networkId:y}),a.a.createElement($,{walletAddress:m})),a.a.createElement(E.a,null,a.a.createElement(z,{width:350,style:{padding:50,backgroundColor:"#FAFDFF"}},m&&a.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:250,justifyContent:"flex-start"}},a.a.createElement(T,{tokenSelectOpts:G,onChange:function(e){s({type:"TOKEN_SELECTED",tokenIndex:e})}}))),a.a.createElement(V,{style:{padding:50,backgroundColor:"#FAFDFF"}},g&&a.a.createElement(k.a,{message:g,type:"error",closable:!0,showIcon:!0}),I&&D&&a.a.createElement(r.Fragment,null,a.a.createElement(A.a,{orientation:"left"},"Token features"),a.a.createElement(Q,{features:D,pmEnabled:w,onClick:function(e){return R.apply(this,arguments)}})),I&&D&&x&&j.length>0&&a.a.createElement(a.a.Fragment,null,a.a.createElement(A.a,{orientation:"left"},"Delegates (administrators and operators)"),a.a.createElement(U,{records:j,roles:x,revokeRole:L,assignRole:S})))))))},Y=function(e){return function(t,n){var r,a=Object.keys(e).reduce((function(a,s){return a[s]=e[s](t[s],n),r=r||a[s]!==t[s],a}),{});return r?a:t}}({AppReducer:function(e,t){switch(console.log("ACTION",t),t.type){case"INITALIZING":return B({},e,{loading:!0,loadingMessage:"Initializing Polymath SDK",error:void 0});case"INITIALIZED":return B({},e,{loading:!1,loadingMessage:"",error:void 0,sdk:t.sdk,networkId:t.networkId,walletAddress:t.walletAddress});case"ERROR":return B({},e,{loading:!1,loadingMessage:"",error:t.error});case"LOADING_TOKENS":return B({},e,{loading:!0,loadingMessage:"Loading tokens"});case"TOKEN_SELECTED":return B({},e,{tokenIndex:t.tokenIndex,pmEnabled:void 0});case"LOADING_DELEGATES":return B({},e,{loading:!0,loadingMessage:"Loading delegates"});case"LOADING_FEATURES_STATUS":return B({},e,{loading:!0,loadingMessage:"Loading features status"});case"REMOVING_DELEGATE":case"ADDING_DELEGATE":var n=t.address;return B({},e,{address:n,loading:!0,loadingMessage:"REMOVING_DELEGATE"===t.type?"Revoking roles of ".concat(n):"Adding delegate ".concat(n)});case"LOADED_TOKENS":case"TOGGLED_PM":case"LOADED_DELEGATES":case"REMOVED_DELEGATE":case"ADDED_DELEGATE":case"LOADED_FEATURES_STATUS":t.type;return B({},e,{},Object(d.a)(t,["type"]),{loading:!1,loadingMessage:""});case"TOGGLING_PM":return B({},e,{loading:!0,loadingMessage:"Toggling permission management"});default:throw new Error("Unrecognized action type: ".concat(t.type))}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.d(t,"Store",(function(){return te})),n.d(t,"_split",(function(){return ne}));var ee={AppReducer:{sdk:void 0,loading:!1,loadingMessage:"",error:void 0,networkId:-1,walletAddress:"",tokens:[],tokenIndex:void 0,pmEnabled:void 0,delegates:[],features:void 0}},te=Object(r.createContext)(),ne=function(e){return e.split(/(?=[A-Z])/)};o.a.render(a.a.createElement((function(){var e=Object(r.useReducer)(Y,ee);return a.a.createElement(te.Provider,{value:e},a.a.createElement(X,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},443:function(e,t,n){e.exports=n(1193)},448:function(e,t,n){},560:function(e,t){},562:function(e,t){},581:function(e,t){},583:function(e,t){},869:function(e,t){}},[[443,1,2]]]);
//# sourceMappingURL=main.6b1806f8.chunk.js.map