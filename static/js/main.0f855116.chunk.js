(window.webpackJsonppermissions=window.webpackJsonppermissions||[]).push([[0],{369:function(e,t,n){e.exports=n(963)},374:function(e,t,n){},488:function(e,t){},490:function(e,t){},509:function(e,t){},512:function(e,t){},805:function(e,t){},963:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(13),s=n.n(o),c=(n(374),n(5)),l=n.n(c),i=n(91),u=n(366),d=n(367),p=n(352),E=n(168),f=n(965),g=n(967),m=n(23),y=n(362),b=n(968),h=n(130),w=g.a.Text,v=g.a.Title,k=h.a.Option;function O(e){var t=e.tokenSelectOpts,n=e.onChange;return a.a.createElement(a.a.Fragment,null,a.a.createElement(v,{level:3},"Please Select a Token"),a.a.createElement(w,{style:{paddingTop:20,paddingBottom:20,width:"100%"}},"Once you select a token, you will be able to manage token holders white-list by adding, editing or removing token holders."),a.a.createElement(h.a,{autoFocus:!0,showSearch:!0,style:{width:"100%",marginBottom:40},placeholder:"Select a token",optionFilterProp:"children",onChange:function(e){return n(e)},filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map((function(e){var t=e.label,n=e.value;return a.a.createElement(k,{key:n,value:n},t)}))))}var T=n(966),I=n(964),x=n(169),A=T.a.Column,D=g.a.Text;function C(e){var t=e.enabled,n=e.onChange,o=e.delegates,s=e.removeDelegate;return o=o.map((function(e){return{key:e,address:e}})),a.a.createElement(r.Fragment,null,a.a.createElement(I.a,{checked:t,onChange:n}),a.a.createElement(T.a,{dataSource:o,rowKey:"address"},a.a.createElement(A,{title:"Address",dataIndex:"address",key:"address",render:function(e){return a.a.createElement(D,null,e)}}),a.a.createElement(A,{render:function(e,t){return a.a.createElement(r.Fragment,null,a.a.createElement(x.a,{onClick:function(){return s(t.address)}},a.a.createElement(m.a,{type:"delete",theme:"filled"})))}})))}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=f.a.Content,G=f.a.Header,_=g.a.Text,M="Permissions",R="ShareholdersAdministrator",N={1:{polymathRegistryAddress:"0xdfabf3e4793cd30affb47ab6fa4cf4eef26bbc27"},42:{polymathRegistryAddress:"0x5b215a7d39ee305ad28da29bf2f0425c6c2a00b3"},15:{polymathRegistryAddress:"0x9FBDa871d559710256a2502A2517b794B482Db40"}};function P(e){var t=e.networkId;return a.a.createElement(r.Fragment,null,a.a.createElement(m.a,{type:"global",style:{marginRight:10,marginLeft:20}}),a.a.createElement(_,null,{0:"Disconnected",1:"Mainnet",42:"Kovan"}[t]))}function L(e){var t=e.walletAddress;return t?a.a.createElement(r.Fragment,null,a.a.createElement(m.a,{type:"user",style:{marginRight:5,marginLeft:10}}),a.a.createElement(_,null,t)):null}var H=function(){var e=Object(r.useContext)(B),t=Object(u.a)(e,2),n=t[0],o=t[1],s=n.AppReducer,c=s.sdk,d=s.loading,p=s.loadingMessage,g=s.walletAddress,m=s.error,h=s.networkId,w=s.tokens,v=s.tokenIndex,k=s.pmEnabled,T=s.delegates,I=w[v];Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(l.a.mark((function e(){var t,n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"INITALIZING"}),e.prev=1,e.next=4,E.browserUtils.getNetworkId();case 4:return t=e.sent,e.next=7,E.browserUtils.getCurrentAddress();case 7:if(n=e.sent,[-1,1,42].includes(t)){e.next=11;break}return o({type:"ERROR",error:"Please switch to either Main or Kovan network"}),e.abrupt("return");case 11:return r=N[t],a=new E.Polymath,e.next=15,a.connect(r);case 15:o({type:"INITIALIZED",networkId:t,sdk:a,walletAddress:n}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),o({type:"ERROR",error:e.t0.message});case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}c||function(){e.apply(this,arguments)}()}),[o,c]),Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(l.a.mark((function e(t,n,r){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"FETCHING_TOKENS"}),e.next=3,n.getSecurityTokens({walletAddress:r});case 3:a=e.sent,t({type:"FETCHED_TOKENS",tokens:a});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}c&&g&&0===w.length&&function(t,n,r){e.apply(this,arguments)}(o,c,g)}),[g,c,o,w]),Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"FETCHING_PM_STATUS"}),e.next=3,I.features.isEnabled({feature:M});case 3:t=e.sent,o({type:"FETCHED_PM_STATUS",pmEnabled:t});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}I&&void 0===k&&function(){e.apply(this,arguments)}()}),[o,k,I]),Object(r.useEffect)((function(){function e(){return(e=Object(i.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"FETCHING_DELEGATES"}),e.next=3,I.permissions.getDelegatesForRole({role:R});case 3:t=e.sent,console.log("delegates",t),o({type:"FETCHED_DELEGATES",delegates:t});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}k&&function(){e.apply(this,arguments)}()}),[w,k,o,I]);var x=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,r,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o({type:"TOGGLING_PM"}),!t){e.next=11;break}return e.next=4,I.features.enable(M);case 4:return n=e.sent,e.next=7,n.run();case 7:r=e.sent,console.log(r),e.next=18;break;case 11:return e.next=13,I.features.disable(M);case 13:return a=e.sent,e.next=16,a.run();case 16:s=e.sent,console.log(s);case 18:o({type:"TOGGLED_PM",pmEnabled:!t});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(i.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({type:"REMOVING_DELEGATE",address:t}),e.next=3,I.permissions.revokeRole({delegateAddress:t,role:R});case 3:return n=e.sent,console.log(n),e.next=7,n.run();case 7:r=e.sent,console.log("res",r),o({type:"REMOVED_DELEGATE"});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=w.map((function(e,t){return{label:e.symbol,value:t}}));return a.a.createElement("div",null,a.a.createElement(y.a,{spinning:d,tip:p,size:"large"},a.a.createElement(f.a,null,a.a.createElement(G,{style:{backgroundColor:"white",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},a.a.createElement(P,{networkId:h}),a.a.createElement(L,{walletAddress:g})),a.a.createElement(j,{style:{padding:50,backgroundColor:"#FAFDFF"}},m&&a.a.createElement(b.a,{message:m,type:"error",closable:!0,showIcon:!0}),g&&a.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:250,justifyContent:"flex-start"}},a.a.createElement(O,{tokenSelectOpts:D,onChange:function(e){o({type:"TOKEN_SELECTED",tokenIndex:e})}})),I&&a.a.createElement(a.a.Fragment,null,a.a.createElement(C,{enabled:k,onChange:x,delegates:T,removeDelegate:A}))))))},K=function(e){return function(t,n){var r,a=Object.keys(e).reduce((function(a,o){return a[o]=e[o](t[o],n),r=r||a[o]!==t[o],a}),{});return r?a:t}}({AppReducer:function(e,t){switch(console.log("ACTION",t),t.type){case"INITALIZING":return F({},e,{loading:!0,loadingMessage:"Initializing Polymath SDK",error:void 0});case"INITIALIZED":return F({},e,{loading:!1,loadingMessage:"",error:void 0,sdk:t.sdk,networkId:t.networkId,walletAddress:t.walletAddress});case"ERROR":return F({},e,{loading:!1,loadingMessage:"",error:t.error});case"FETCHING_TOKENS":return F({},e,{loading:!0,loadingMessage:"Fetching tokens"});case"TOKEN_SELECTED":return F({},e,{tokenIndex:t.tokenIndex,pmEnabled:void 0});case"FETCHING_PM_STATUS":return F({},e,{loading:!0,loadingMessage:"Fetching permissions feature status"});case"FETCHING_DELEGATES":return F({},e,{loading:!0,loadingMessage:"Fetching delegates"});case"REMOVING_DELEGATE":var n=t.address;return F({},e,{address:n,loading:!0,loadingMessage:"Revoking roles of ".concat(n)});case"FETCHED_TOKENS":case"FETCHED_PM_STATUS":case"TOGGLED_PM":case"FETCHED_DELEGATES":case"REMOVED_DELEGATE":t.type;return F({},e,{},Object(d.a)(t,["type"]),{loading:!1,loadingMessage:""});case"TOGGLING_PM":return F({},e,{loading:!0,loadingMessage:"Toggling permission management"});default:throw new Error("Unrecognized action type: ".concat(t.type))}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.d(t,"Store",(function(){return B}));var U={AppReducer:{sdk:void 0,loading:!1,loadingMessage:"",error:void 0,networkId:-1,walletAddress:"",tokens:[],tokenIndex:void 0,pmEnabled:void 0,delegates:[]}},B=Object(r.createContext)();s.a.render(a.a.createElement((function(){var e=Object(r.useReducer)(K,U);return a.a.createElement(B.Provider,{value:e},a.a.createElement(H,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[369,1,2]]]);
//# sourceMappingURL=main.0f855116.chunk.js.map