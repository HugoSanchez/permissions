(window.webpackJsonppermissions=window.webpackJsonppermissions||[]).push([[0],{1047:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(6),s=n.n(o),c=(n(419),n(3)),l=n.n(c),i=n(194),u=n(67),d=n(412),p=n(393),f=n(196),m=n(1048),E=n(1052),g=n(11),b=n(1057),y=n(1055),v=n(66),k=n(403),h=n(1056),w=n(1049),x=n(154),O=E.a.Text,A=E.a.Title,C=x.a.Option;function R(e){var t=e.tokenSelectOpts,n=e.onChange;return a.a.createElement(a.a.Fragment,null,a.a.createElement(A,{level:3},"Please Select a Token"),a.a.createElement(O,{style:{paddingTop:20,paddingBottom:20,width:"100%"}},"Once you select a token, you will be able to manage administrators and operators of various Security Token features"),a.a.createElement(x.a,{autoFocus:!0,showSearch:!0,style:{width:"100%",marginBottom:40},placeholder:"Select a token",optionFilterProp:"children",onChange:function(e){return n(e)},filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map((function(e){var t=e.label,n=e.value;return a.a.createElement(C,{key:n,value:n},t)}))))}var S=n(1050),j=n(1051),T=n(1053),I=n(1054),P=n(400),D=n(401),N=S.a.Column,_=E.a.Text,F=j.a.Item,L=x.a.Option,Y={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},M={PermissionsAdministrator:"Permissions Administrator",ShareholdersAdministrator:"Shareholders Administrator"};function K(e){var t=e.records,n=e.revokeRole,o=e.assignRole,s=e.roles;t=t.map((function(e){var t=e.address;return{key:t,address:t,role:e.role}}));var c=Object(P.a)(),d=c.getFieldDecorator,p=c.validateFields,f=(c.errors,c.values,c.resetFields),m=Object(r.useState)(!1),E=Object(i.a)(m,2),b=E[0],y=E[1],k=s.map((function(e){return{value:e,label:M[e]}})),h=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(["address","role"],{force:!0}).then(function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.prev=1,e.next=4,o(t.address,t.role);case 4:f(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:y(!1);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(v.a,{type:"primary",onClick:function(){return y(!0)},style:{alignSelf:"flex-end",marginBottom:20}},"Assign a role"),a.a.createElement(T.a,{zIndex:0,title:"Assign a role",okText:"Save",closable:!1,visible:b,footer:null},a.a.createElement(j.a,Y,a.a.createElement(F,{name:"address",label:"Address"},d("address",{rules:[{required:!0},{validator:function(e,t,n){D.utils.isAddress(t)?n():n("Address is invalid")}}]})(a.a.createElement(I.a,null))),a.a.createElement(F,{name:"role",label:"Role"},d("role",{rules:[{required:!0}]})(a.a.createElement(x.a,null,k.map((function(e){var t=e.value,n=e.label;return a.a.createElement(L,{key:n,value:t},n)}))))),a.a.createElement(F,{name:"details",label:"Details"},d("details")(a.a.createElement(I.a,null))),a.a.createElement(F,null,a.a.createElement(v.a,{onClick:function(){return y(!1)}},"Cancel"),a.a.createElement(v.a,{type:"primary",onClick:h},"Save")))),a.a.createElement(S.a,{style:{zIndex:0},size:"middle",dataSource:t,rowKey:function(e,t){return"".concat(e,"-").concat(t)}},a.a.createElement(N,{title:"Address",dataIndex:"address",key:"address",render:function(e){return a.a.createElement(_,null,e)}}),a.a.createElement(N,{title:"Role",dataIndex:"role",key:"role",render:function(e){return a.a.createElement(_,null,ae(e))}}),a.a.createElement(N,{title:"Actions",render:function(e,t){return a.a.createElement(r.Fragment,null,a.a.createElement(v.a,{onClick:function(){return n(t.address,t.role)}},a.a.createElement(g.a,{type:"delete",theme:"filled"})))}})))}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=m.a.Content,q=m.a.Header,J=m.a.Sider,W=E.a.Text,H="Permissions",Z={1:{polymathRegistryAddress:"0xdfabf3e4793cd30affb47ab6fa4cf4eef26bbc27"},42:{polymathRegistryAddress:"0x5b215a7d39ee305ad28da29bf2f0425c6c2a00b3"},15:{polymathRegistryAddress:"0x9FBDa871d559710256a2502A2517b794B482Db40"}};function $(e){var t=e.networkId;return a.a.createElement(r.Fragment,null,a.a.createElement(g.a,{type:"global",style:{marginRight:10,marginLeft:20}}),a.a.createElement(W,null,{0:"Disconnected",1:"Mainnet",42:"Kovan"}[t]))}function G(e){var t=e.walletAddress;return t?a.a.createElement(r.Fragment,null,a.a.createElement(g.a,{type:"user",style:{marginRight:5,marginLeft:10}}),a.a.createElement(W,null,t)):null}function Q(e){var t=e.features,n=e.pmEnabled,r=e.onClick;return a.a.createElement(b.a,{column:4,style:{marginBottom:50}},a.a.createElement(b.a.Item,{key:"Permissions",label:"Permissions"},n?a.a.createElement(y.a,{status:"success",text:"enabled"}):a.a.createElement(v.a,{type:"primary",onClick:r},"Enable")),"}",Object.keys(t).map((function(e){return a.a.createElement(b.a.Item,{key:e,label:ae(e)},a.a.createElement(y.a,{status:t[e]?"success":"error",text:t[e]?"enabled":"disabled"}))})))}function V(e,t){return X.apply(this,arguments)}function X(){return(X=Object(u.a)(l.a.mark((function e(t,n){var r,a,o=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:"",e.prev=1,t({type:"ASYNC_START",msg:r}),e.next=5,n();case 5:a=e.sent,t(z({type:"ASYNC_COMPLETE"},a)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t({type:"ASYNC_ERROR",error:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var ee=function(){var e=Object(r.useContext)(re),t=Object(i.a)(e,2),n=t[0],o=t[1],s=n.AppReducer,c=s.sdk,d=s.loading,p=s.loadingMessage,E=s.walletAddress,g=s.error,b=s.networkId,y=s.tokens,v=s.tokenIndex,x=s.pmEnabled,O=s.records,A=s.features,C=s.availableRoles,S=y[v];function j(){return(j=Object(u.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o({type:"ASYNC_START",msg:"Toggle role management"}),!t){e.next=11;break}return e.next=5,S.features.enable({feature:H});case 5:return n=e.sent,e.next=8,n.run();case 8:e.sent,e.next=17;break;case 11:return e.next=13,S.features.disable({feature:H});case 13:return r=e.sent,e.next=16,r.run();case 16:e.sent;case 17:o({type:"ASYNC_COMPLETE",pmEnabled:!t}),o({type:"TOKEN_SELECTED",tokenIndex:v}),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),console.error(e.t0),o({type:"ASYNC_ERROR",error:e.t0.message});case 25:case"end":return e.stop()}}),e,null,[[0,21]])})))).apply(this,arguments)}Object(r.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(){var t,n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.browserUtils.getNetworkId();case 2:return t=e.sent,e.next=5,f.browserUtils.getCurrentAddress();case 5:if(n=e.sent,[-1,1,42].includes(t)){e.next=9;break}return o({type:"ERROR",error:"Please switch to either Main or Kovan network"}),e.abrupt("return");case 9:return r=Z[t],a=new f.Polymath,e.next=13,a.connect(r);case 13:return e.abrupt("return",{networkId:t,sdk:a,walletAddress:n});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}c||V(o,(function(){return function(){return e.apply(this,arguments)}()}),"Initializing Polymath SDK")}),[o,c]),Object(r.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getSecurityTokens({walletAddress:n});case 2:return r=e.sent,e.abrupt("return",{tokens:r});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}c&&E&&0===y.length&&V(o,(function(){return function(t,n){return e.apply(this,arguments)}(c,E)}),"Loading tokens")}),[E,c,o,y]),Object(r.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.features.getStatus();case 2:if(t=e.sent,n=[],r=t[H],delete t[H],!r){e.next=10;break}return e.next=9,S.permissions.getAvailableRoles();case 9:n=e.sent;case 10:return e.abrupt("return",{availableRoles:n,features:t,pmEnabled:r});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}S&&!A&&V(o,(function(){return function(){return e.apply(this,arguments)}()}),"Loading features status")}),[o,A,S]),Object(r.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.permissions.getAllDelegates();case 2:return t=e.sent,n=t.reduce((function(e,n,r){return e.concat(n.roles.map((function(e){return{address:t[r].delegateAddress,role:e}})))}),[]),e.abrupt("return",{delegates:t,records:n});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}S&&x&&V(o,(function(){return function(){return e.apply(this,arguments)}()}),"Loading delegates")}),[x,o,S]);var T=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o({type:"ASYNC_START",msg:"Revoking ".concat(n," role from ").concat(t)}),e.next=4,S.permissions.revokeRole({delegateAddress:t,role:n});case 4:return r=e.sent,e.next=7,r.run();case 7:e.sent,o({type:"ASYNC_COMPLETE"}),o({type:"TOKEN_SELECTED",tokenIndex:v}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),o({type:"ASYNC_ERROR",error:e.t0.message});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=Object(u.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o({type:"ASYNC_START",msg:"Assigning ".concat(n," role to ").concat(t)}),e.next=4,S.permissions.assignRole({delegateAddress:t,role:n});case 4:e.sent,o({type:"ASYNC_COMPLETE"}),o({type:"TOKEN_SELECTED",tokenIndex:v}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),o({type:"ASYNC_ERROR",error:e.t0.message});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement(k.a,{spinning:d,tip:p,size:"large"},a.a.createElement(m.a,null,a.a.createElement(q,{style:{backgroundColor:"white",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},a.a.createElement($,{networkId:b}),a.a.createElement(G,{walletAddress:E})),a.a.createElement(m.a,null,a.a.createElement(J,{width:350,style:{padding:50,backgroundColor:"#FAFDFF"}},E&&y&&a.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:250,justifyContent:"flex-start"}},a.a.createElement(R,{tokenSelectOpts:y.map((function(e,t){return{label:e.symbol,value:t}})),onChange:function(e){o({type:"TOKEN_SELECTED",tokenIndex:e})}}))),a.a.createElement(U,{style:{padding:50,backgroundColor:"#FAFDFF"}},g&&a.a.createElement(h.a,{message:g,type:"error",closable:!0,showIcon:!0}),S&&A&&a.a.createElement(r.Fragment,null,a.a.createElement(w.a,{orientation:"left"},"Token features"),a.a.createElement(Q,{features:A,pmEnabled:x,onClick:function(e){return j.apply(this,arguments)}})),S&&C&&O&&a.a.createElement(a.a.Fragment,null,a.a.createElement(w.a,{orientation:"left"},"Delegates (administrators and operators)"),a.a.createElement(K,{records:O,roles:C,revokeRole:T,assignRole:I})))))))},te=function(e){return function(t,n){var r,a=Object.keys(e).reduce((function(a,o){return a[o]=e[o](t[o],n),r=r||a[o]!==t[o],a}),{});return r?a:t}}({AppReducer:function(e,t){switch(console.log("ACTION",t),t.type){case"ASYNC_START":return z({},e,{loading:!0,loadingMessage:t.msg,error:void 0});case"ASYNC_COMPLETE":t.type;return z({},e,{},Object(d.a)(t,["type"]),{loading:!1,loadingMessage:"",error:void 0});case"ERROR":case"ASYNC_ERROR":return z({},e,{loading:!1,loadingMessage:"",error:t.error});case"TOKEN_SELECTED":return z({},e,{tokenIndex:t.tokenIndex,delegates:void 0,records:void 0,pmEnabled:void 0,error:void 0,features:void 0});default:throw new Error("Unrecognized action type: ".concat(t.type))}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.d(t,"Store",(function(){return re})),n.d(t,"_split",(function(){return ae}));var ne={AppReducer:{sdk:void 0,loading:!1,loadingMessage:"",error:void 0,networkId:-1,walletAddress:"",tokens:[],tokenIndex:void 0,pmEnabled:void 0,delegates:void 0,features:void 0}},re=Object(r.createContext)(),ae=function(e){return e.split(/(?=[A-Z])/).join(" ")};s.a.render(a.a.createElement((function(){var e=Object(r.useReducer)(te,ne);return a.a.createElement(re.Provider,{value:e},a.a.createElement(ee,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},414:function(e,t,n){e.exports=n(1047)},419:function(e,t,n){},532:function(e,t){},534:function(e,t){},553:function(e,t){},555:function(e,t){},809:function(e,t){}},[[414,1,2]]]);
//# sourceMappingURL=main.18a5672e.chunk.js.map